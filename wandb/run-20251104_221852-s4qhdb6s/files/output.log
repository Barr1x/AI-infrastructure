  0%|                                                                                 | 0/114 [00:00<?, ?it/s]WARNING:transformers_modules.GPTNeoX-160m.modeling_custom:`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
                                                                                                              
{'loss': 10.9376, 'grad_norm': 3.921875, 'learning_rate': 2.4999999999999998e-05, 'epoch': 0.03}
{'loss': 10.958, 'grad_norm': 3.75, 'learning_rate': 4.9999999999999996e-05, 'epoch': 0.05}
{'loss': 10.7976, 'grad_norm': 3.6875, 'learning_rate': 7.5e-05, 'epoch': 0.08}
{'loss': 10.4562, 'grad_norm': 2.6875, 'learning_rate': 9.999999999999999e-05, 'epoch': 0.1}
{'loss': 10.1238, 'grad_norm': 2.3125, 'learning_rate': 0.000125, 'epoch': 0.13}
{'loss': 10.0043, 'grad_norm': 1.9296875, 'learning_rate': 0.00015, 'epoch': 0.16}
{'loss': 9.7685, 'grad_norm': 1.9921875, 'learning_rate': 0.000175, 'epoch': 0.18}
{'loss': 9.683, 'grad_norm': 1.734375, 'learning_rate': 0.00019999999999999998, 'epoch': 0.21}
{'loss': 9.6538, 'grad_norm': 1.609375, 'learning_rate': 0.000225, 'epoch': 0.23}
{'loss': 9.4038, 'grad_norm': 1.6328125, 'learning_rate': 0.00025, 'epoch': 0.26}
{'loss': 9.3007, 'grad_norm': 1.6328125, 'learning_rate': 0.00027499999999999996, 'epoch': 0.29}
{'loss': 9.0843, 'grad_norm': 1.625, 'learning_rate': 0.0003, 'epoch': 0.31}
{'loss': 8.8582, 'grad_norm': 1.5, 'learning_rate': 0.0002999288579570049, 'epoch': 0.34}
{'loss': 8.8463, 'grad_norm': 1.234375, 'learning_rate': 0.0002997154993105566, 'epoch': 0.36}
{'loss': 8.6874, 'grad_norm': 1.140625, 'learning_rate': 0.00029936012644425517, 'epoch': 0.39}
{'loss': 8.4545, 'grad_norm': 1.1875, 'learning_rate': 0.0002988630764507904, 'epoch': 0.42}
{'loss': 8.3385, 'grad_norm': 1.03125, 'learning_rate': 0.00029822482081218887, 'epoch': 0.44}
{'loss': 8.2573, 'grad_norm': 1.0078125, 'learning_rate': 0.00029744596495258525, 'epoch': 0.47}
{'loss': 8.0353, 'grad_norm': 1.0546875, 'learning_rate': 0.00029652724766394007, 'epoch': 0.49}
{'loss': 7.9072, 'grad_norm': 0.94140625, 'learning_rate': 0.0002954695404052514, 'epoch': 0.52}
{'loss': 7.9428, 'grad_norm': 0.82421875, 'learning_rate': 0.00029427384647592284, 'epoch': 0.55}
{'loss': 7.7585, 'grad_norm': 1.2421875, 'learning_rate': 0.0002929413000640735, 'epoch': 0.57}
{'loss': 7.7653, 'grad_norm': 0.6796875, 'learning_rate': 0.00029147316517069157, 'epoch': 0.6}
{'loss': 7.8018, 'grad_norm': 0.671875, 'learning_rate': 0.0002898708344106533, 'epoch': 0.62}
{'loss': 7.71, 'grad_norm': 0.65234375, 'learning_rate': 0.000288135827691743, 'epoch': 0.65}
{'loss': 7.7348, 'grad_norm': 0.71484375, 'learning_rate': 0.0002862697907729285, 'epoch': 0.68}
{'loss': 7.7243, 'grad_norm': 0.65625, 'learning_rate': 0.00028427449370325937, 'epoch': 0.7}
{'loss': 7.7054, 'grad_norm': 1.9609375, 'learning_rate': 0.00028215182914286766, 'epoch': 0.73}
{'loss': 7.5754, 'grad_norm': 0.75, 'learning_rate': 0.0002799038105676658, 'epoch': 0.75}
{'loss': 7.6346, 'grad_norm': 0.58203125, 'learning_rate': 0.0002775325703594421, 'epoch': 0.78}
{'loss': 7.6409, 'grad_norm': 0.74609375, 'learning_rate': 0.0002750403577831679, 'epoch': 0.81}
{'loss': 7.5813, 'grad_norm': 0.7109375, 'learning_rate': 0.00027242953685343327, 'epoch': 0.83}
{'loss': 7.5724, 'grad_norm': 0.56640625, 'learning_rate': 0.00026970258409203594, 'epoch': 0.86}
{'loss': 7.4422, 'grad_norm': 0.64453125, 'learning_rate': 0.00026686208617885055, 'epoch': 0.88}
{'loss': 7.4456, 'grad_norm': 0.7421875, 'learning_rate': 0.00026391073749820607, 'epoch': 0.91}
{'loss': 7.5317, 'grad_norm': 0.65234375, 'learning_rate': 0.00026085133758309883, 'epoch': 0.94}
{'loss': 7.4299, 'grad_norm': 0.76953125, 'learning_rate': 0.0002576867884596663, 'epoch': 0.96}
{'loss': 7.4774, 'grad_norm': 0.75390625, 'learning_rate': 0.000254420091894439, 'epoch': 0.99}
                                                                                                              
{'eval_loss': 7.446563243865967, 'eval_runtime': 327.3995, 'eval_samples_per_second': 45.816, 'eval_steps_per_second': 5.727, 'epoch': 0.99}
{'loss': 7.3638, 'grad_norm': 0.5703125, 'learning_rate': 0.00025105434654698356, 'epoch': 1.01}
{'loss': 7.3881, 'grad_norm': 0.56640625, 'learning_rate': 0.0002475927450306363, 'epoch': 1.04}
{'loss': 7.1579, 'grad_norm': 0.63671875, 'learning_rate': 0.000244038570884116, 'epoch': 1.06}
{'loss': 7.2155, 'grad_norm': 0.9140625, 'learning_rate': 0.00024039519545688846, 'epoch': 1.09}
{'loss': 7.1602, 'grad_norm': 0.73046875, 'learning_rate': 0.00023666607471123767, 'epoch': 1.12}
{'loss': 7.2267, 'grad_norm': 0.7421875, 'learning_rate': 0.00023285474594407585, 'epoch': 1.14}
{'loss': 7.3848, 'grad_norm': 0.5390625, 'learning_rate': 0.00022896482443160335, 'epoch': 1.17}
{'loss': 7.3124, 'grad_norm': 0.66796875, 'learning_rate': 0.000225, 'epoch': 1.19}
{'loss': 7.2871, 'grad_norm': 0.5625, 'learning_rate': 0.0002209640335254015, 'epoch': 1.22}
{'loss': 7.3881, 'grad_norm': 0.58203125, 'learning_rate': 0.00021686075336648075, 'epoch': 1.25}
{'loss': 7.2441, 'grad_norm': 0.53125, 'learning_rate': 0.0002126940517330175, 'epoch': 1.27}
{'loss': 7.233, 'grad_norm': 0.56640625, 'learning_rate': 0.00020846788099390188, 'epoch': 1.3}
{'loss': 7.2591, 'grad_norm': 0.5703125, 'learning_rate': 0.00020418624992807295, 'epoch': 1.32}
{'loss': 7.2564, 'grad_norm': 0.578125, 'learning_rate': 0.00019985321992194892, 'epoch': 1.35}
{'loss': 7.0162, 'grad_norm': 0.57421875, 'learning_rate': 0.0001954729011169565, 'epoch': 1.38}
{'loss': 7.1136, 'grad_norm': 0.65234375, 'learning_rate': 0.00019104944851081244, 'epoch': 1.4}
{'loss': 7.0975, 'grad_norm': 0.578125, 'learning_rate': 0.00018658705801625656, 'epoch': 1.43}
{'loss': 7.2594, 'grad_norm': 0.470703125, 'learning_rate': 0.00018208996248097458, 'epoch': 1.45}
{'loss': 7.0631, 'grad_norm': 0.53125, 'learning_rate': 0.00017756242767248557, 'epoch': 1.48}
{'loss': 7.012, 'grad_norm': 0.52734375, 'learning_rate': 0.00017300874823180282, 'epoch': 1.51}
{'loss': 7.0609, 'grad_norm': 0.53515625, 'learning_rate': 0.00016843324359970712, 'epoch': 1.53}
{'loss': 7.1069, 'grad_norm': 0.61328125, 'learning_rate': 0.0001638402539194953, 'epoch': 1.56}
{'loss': 7.1373, 'grad_norm': 0.5546875, 'learning_rate': 0.00015923413592009144, 'epoch': 1.58}
{'loss': 7.0749, 'grad_norm': 0.48046875, 'learning_rate': 0.00015461925878342556, 'epoch': 1.61}
{'loss': 7.0796, 'grad_norm': 0.5390625, 'learning_rate': 0.00015, 'epoch': 1.64}
{'loss': 6.913, 'grad_norm': 0.58984375, 'learning_rate': 0.00014538074121657447, 'epoch': 1.66}
{'loss': 6.8929, 'grad_norm': 0.6640625, 'learning_rate': 0.00014076586407990856, 'epoch': 1.69}
{'loss': 7.0311, 'grad_norm': 0.6015625, 'learning_rate': 0.0001361597460805047, 'epoch': 1.71}
{'loss': 6.9105, 'grad_norm': 0.515625, 'learning_rate': 0.00013156675640029289, 'epoch': 1.74}
{'loss': 6.9048, 'grad_norm': 0.60546875, 'learning_rate': 0.00012699125176819716, 'epoch': 1.77}
{'loss': 6.9318, 'grad_norm': 0.59375, 'learning_rate': 0.0001224375723275144, 'epoch': 1.79}
{'loss': 6.9134, 'grad_norm': 0.51171875, 'learning_rate': 0.00011791003751902542, 'epoch': 1.82}
{'loss': 6.8067, 'grad_norm': 0.5625, 'learning_rate': 0.00011341294198374341, 'epoch': 1.84}
{'loss': 7.0714, 'grad_norm': 0.490234375, 'learning_rate': 0.00010895055148918756, 'epoch': 1.87}
{'loss': 6.9985, 'grad_norm': 0.458984375, 'learning_rate': 0.00010452709888304347, 'epoch': 1.9}
{'loss': 6.7927, 'grad_norm': 0.5703125, 'learning_rate': 0.00010014678007805106, 'epoch': 1.92}
{'loss': 6.8048, 'grad_norm': 0.59765625, 'learning_rate': 9.581375007192705e-05, 'epoch': 1.95}
{'loss': 6.9569, 'grad_norm': 0.44921875, 'learning_rate': 9.15321190060981e-05, 'epoch': 1.97}
{'loss': 6.9373, 'grad_norm': 0.4921875, 'learning_rate': 8.730594826698253e-05, 'epoch': 2.0}
{'eval_loss': 7.011351108551025, 'eval_runtime': 326.7714, 'eval_samples_per_second': 45.904, 'eval_steps_per_second': 5.738, 'epoch': 2.0}
{'loss': 6.9076, 'grad_norm': 0.46875, 'learning_rate': 8.313924663351926e-05, 'epoch': 2.03}
{'loss': 6.7323, 'grad_norm': 0.46484375, 'learning_rate': 7.90359664745985e-05, 'epoch': 2.05}
{'loss': 6.7605, 'grad_norm': 0.5234375, 'learning_rate': 7.500000000000002e-05, 'epoch': 2.08}
{'loss': 6.8799, 'grad_norm': 0.5, 'learning_rate': 7.10351755683966e-05, 'epoch': 2.1}
{'loss': 6.8912, 'grad_norm': 0.4609375, 'learning_rate': 6.714525405592412e-05, 'epoch': 2.13}
{'loss': 6.8034, 'grad_norm': 0.494140625, 'learning_rate': 6.333392528876233e-05, 'epoch': 2.16}
{'loss': 6.8871, 'grad_norm': 0.380859375, 'learning_rate': 5.960480454311155e-05, 'epoch': 2.18}
{'loss': 6.732, 'grad_norm': 0.462890625, 'learning_rate': 5.596142911588406e-05, 'epoch': 2.21}
{'loss': 6.8014, 'grad_norm': 0.490234375, 'learning_rate': 5.240725496936372e-05, 'epoch': 2.23}
{'loss': 6.8103, 'grad_norm': 0.47265625, 'learning_rate': 4.8945653453016415e-05, 'epoch': 2.26}
{'loss': 6.9834, 'grad_norm': 0.47265625, 'learning_rate': 4.5579908105561016e-05, 'epoch': 2.29}
{'loss': 6.8115, 'grad_norm': 0.484375, 'learning_rate': 4.231321154033372e-05, 'epoch': 2.31}
{'loss': 6.7995, 'grad_norm': 0.451171875, 'learning_rate': 3.914866241690115e-05, 'epoch': 2.34}
{'loss': 6.6653, 'grad_norm': 0.51171875, 'learning_rate': 3.6089262501793915e-05, 'epoch': 2.36}
{'loss': 6.7601, 'grad_norm': 0.458984375, 'learning_rate': 3.3137913821149425e-05, 'epoch': 2.39}
{'loss': 6.7319, 'grad_norm': 0.41796875, 'learning_rate': 3.0297415907964073e-05, 'epoch': 2.42}
{'loss': 6.718, 'grad_norm': 0.51171875, 'learning_rate': 2.7570463146566758e-05, 'epoch': 2.44}
{'loss': 6.9019, 'grad_norm': 0.453125, 'learning_rate': 2.495964221683209e-05, 'epoch': 2.47}
{'loss': 6.6883, 'grad_norm': 0.42578125, 'learning_rate': 2.24674296405579e-05, 'epoch': 2.49}
{'loss': 6.8216, 'grad_norm': 0.5, 'learning_rate': 2.009618943233419e-05, 'epoch': 2.52}
{'loss': 6.8178, 'grad_norm': 0.494140625, 'learning_rate': 1.7848170857132325e-05, 'epoch': 2.55}
{'loss': 6.6344, 'grad_norm': 0.47265625, 'learning_rate': 1.5725506296740663e-05, 'epoch': 2.57}
{'loss': 6.8054, 'grad_norm': 0.5234375, 'learning_rate': 1.3730209227071436e-05, 'epoch': 2.6}
{'loss': 6.8175, 'grad_norm': 0.53125, 'learning_rate': 1.1864172308256947e-05, 'epoch': 2.62}
{'loss': 6.824, 'grad_norm': 0.439453125, 'learning_rate': 1.0129165589346643e-05, 'epoch': 2.65}
{'loss': 6.7271, 'grad_norm': 0.53125, 'learning_rate': 8.526834829308382e-06, 'epoch': 2.68}
{'loss': 6.9442, 'grad_norm': 0.466796875, 'learning_rate': 7.058699935926526e-06, 'epoch': 2.7}
{'loss': 6.6926, 'grad_norm': 0.51171875, 'learning_rate': 5.7261535240771426e-06, 'epoch': 2.73}
{'loss': 6.9106, 'grad_norm': 0.388671875, 'learning_rate': 4.530459594748592e-06, 'epoch': 2.75}
{'loss': 6.6902, 'grad_norm': 0.5625, 'learning_rate': 3.4727523360598974e-06, 'epoch': 2.78}
{'loss': 6.7798, 'grad_norm': 0.408203125, 'learning_rate': 2.554035047414732e-06, 'epoch': 2.81}
{'loss': 6.672, 'grad_norm': 0.48828125, 'learning_rate': 1.7751791878110933e-06, 'epoch': 2.83}
{'loss': 6.7158, 'grad_norm': 0.412109375, 'learning_rate': 1.1369235492096397e-06, 'epoch': 2.86}
{'loss': 6.7607, 'grad_norm': 0.474609375, 'learning_rate': 6.398735557448297e-07, 'epoch': 2.88}
{'loss': 6.8264, 'grad_norm': 0.41015625, 'learning_rate': 2.845006894433843e-07, 'epoch': 2.91}
{'loss': 6.7989, 'grad_norm': 0.478515625, 'learning_rate': 7.114204299511483e-08, 'epoch': 2.94}
{'loss': 6.828, 'grad_norm': 0.466796875, 'learning_rate': 0.0, 'epoch': 2.96}
{'eval_loss': 6.964308261871338, 'eval_runtime': 326.643, 'eval_samples_per_second': 45.922, 'eval_steps_per_second': 5.74, 'epoch': 2.96}
{'train_runtime': 1191.2662, 'train_samples_per_second': 2.518, 'train_steps_per_second': 0.096, 'train_loss': 7.483577021381311, 'epoch': 2.96}
Perplexity (2048): 1058.18
